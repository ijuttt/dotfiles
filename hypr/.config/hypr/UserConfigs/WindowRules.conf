source = $UserConfigs/01-UserDefaults.conf

# ========================== REGEX DEFINITION ===========================
$regex_browser = ^($browser|[Ff]irefox|org.mozilla.firefox|[Ff]irefox-esr|[Ff]irefox-bin|[Gg]oogle-chrome.*|chrome-.+-Default|[Cc]hromium|Brave-browser.*|brave-browser|zen.*)$
$regex_term    = ^($term|Alacritty|kitty|kitty-dropterm)$
$regex_file    = ^([Tt]hunar|org.gnome.Nautilus|[Pp]cmanfm-qt|app.drey.Warp|yazi)$
$regex_im      = ^([Kk]arere|io.github.tobagin.karere|ZapZap|com.rtosta.zapzap|org.telegram.desktop|[Ff]erdium)$
$regex_dev     = ^(codium|codium-url-handler|VSCodium|VSCode|code-url-handler|jetbrains-.+)$
$regex_settings = ^(wihotspot.*|[Bb]aobab|org.gnome.[Bb]aobab|gnome-disks|file-roller|org.gnome.FileRoller|nm-applet|nm-connection-editor|blueman-manager|blueberry|iwgtk|pavucontrol|org.pulseaudio.pavucontrol|com.saivert.pwvucontrol|qt[56]ct|[Yy]ad|xdg-desktop-portal-gtk|org.kde.polkit-kde-authentication-agent-1|[Rr]ofi)$

# ========================== TAGS ===========================
windowrule = tag +browser, match:class $regex_browser
windowrule = tag +terminal, match:class $regex_term
windowrule = tag +file-manager, match:class $regex_file
windowrule = tag +im, match:class $regex_im
windowrule = tag +projects, match:class $regex_dev
windowrule = tag +settings, match:class $regex_settings
windowrule = tag +notif, match:class ^(swaync.*)$
windowrule = tag +multimedia, match:class ^([Aa]udacious)$
windowrule = tag +multimedia_video, match:class ^([Mm]pv|vlc)$
windowrule = tag +viewer, match:class ^(gnome-system-monitor|org.gnome.SystemMonitor|io.missioncenter.MissionCenter|evince|eog|org.gnome.Loupe)$

# ========================== BEHAVIOR RULES (RULES UTAMA) ===========================

# --- Opacity & Blur ---
windowrule = opacity 0.9 0.8, match:tag projects
windowrule = opacity 0.94 0.86, match:tag im
windowrule = opacity 0.9 0.8, match:tag file-manager
# windowrule = opacity 0.97 0.97, match:tag terminal
windowrule = opacity 1, match:tag terminal
windowrule = opacity 0.95, no_blur on, match:tag browser
windowrule = opacity 1.0, no_blur on, match:tag multimedia_video
windowrule = opacity 0.8, match:class ^(code|gedit|org.gnome.TextEditor|mousepad)$

# --- Floating & Centering ---
windowrule = float on, match:tag settings|viewer|wallpaper|terminal
windowrule = center on, match:tag settings|KooL_Settings
windowrule = float on, size (monitor_w*0.7) (monitor_h*0.7), match:tag wallpaper
windowrule = float on, size (monitor_w*0.7) (monitor_h*0.6), match:tag settings
windowrule = float on, match:class ^(zoom|mpv|com.github.rafostar.Clapper|[Qq]alculate-gtk)$
windowrule = float on, match:title ^(Wi-Fi Network Authentication Required)$

# --- Workspace Assignment ---
windowrule = workspace 1, match:tag browser
windowrule = workspace 4 silent, match:tag screenshare
windowrule = workspace 9 silent, match:tag multimedia
windowrule = workspace special:waTele, match:tag im
windowrule = workspace special:spotifyDiscord, match:class ^(spotify)$

workspace = special:waTele, gapsin:4, gapsout:100
workspace = special:spotifyDiscord, gapsin:4, gapsout:100

# --- Fullscreen when only 1 window
workspace = w[tv1]s[false], gapsout:0, gapsin:0
workspace = f[1]s[false], gapsout:0, gapsin:0
windowrule {
    name = no-gaps-wtv1
    match:float = false
    match:workspace = w[tv1]s[false]
    
    border_size = 0
    rounding = 0
}

windowrule {
    name = no-gaps-f1
    match:float = false
    match:workspace = f[1]s[false]
    
    border_size = 0
    rounding = 0
}

# --- Fix & Overrides ---
windowrule = idle_inhibit fullscreen, match:fullscreen 1
windowrule = stay_focused on, match:class ^(zoom)$
windowrule = no_initial_focus on, match:class ^(zoom|jetbrains-.*)$, match:title ^$
windowrule = move ((monitor_w*0.72)) ((monitor_h*0.07)), float on, pin on, match:title ^(Picture-in-Picture)$
windowrule = center on, size (monitor_w*0.6) (monitor_h*0.6), match:tag multimedia_video

# --- Layer Rules ---
layerrule = blur on, ignore_alpha 0, match:namespace rofi|notifications
layerrule = blur on, ignore_alpha 0.5, match:namespace quickshell:overview
